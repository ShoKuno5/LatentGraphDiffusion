Directory created: /work/jh210022o/q25030/LatentGraphDiffusion/runs/20250710_172433 /work/jh210022o/q25030/LatentGraphDiffusion/data
Testing LGD environment setup...
PyTorch version: 2.0.1
CUDA available: True
CUDA device count: 8
Checking if required packages are installed...
PyG version: 2.3.1
wandb version: 0.18.7
OGB version: 1.3.6
/opt/conda/lib/python3.10/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
Testing LGD modules...
/opt/conda/lib/python3.10/site-packages/lightning_fabric/__init__.py:40: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
LGD utils imported successfully
Running LGD autoencoder pretraining test (short run)...
/opt/conda/lib/python3.10/site-packages/lightning_fabric/__init__.py:40: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
./datasets/ZINC
[*] Loaded dataset 'subset' from 'PyG-ZINC':
/opt/conda/lib/python3.10/site-packages/torch_geometric/data/in_memory_dataset.py:157: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
  Data(x=[277864, 1], edge_index=[2, 597970], edge_attr=[597970], y=[12000])
  undirected: True
  num graphs: 12000
/opt/conda/lib/python3.10/site-packages/torch_geometric/data/in_memory_dataset.py:157: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
  avg num_nodes/graph: 23
  num node features: 1
  num edge features: 1
  num classes: (appears to be a regression task)
Precomputing Positional Encoding statistics: ['RRWP'] for all graphs...
  ...estimated to be undirected: True
  0%|          | 0/12000 [00:00<?, ?it/s]100%|██████████| 12000/12000 [00:07<00:00, 1519.21it/s]
Done! Took 00:00:08.63
Adding virtual node and edges
  0%|          | 0/12000 [00:00<?, ?it/s]100%|██████████| 12000/12000 [00:07<00:00, 1593.77it/s]
Preprocessing PE
  0%|          | 0/12000 [00:00<?, ?it/s]100%|██████████| 12000/12000 [00:03<00:00, 3375.58it/s]
[*] Run ID 0: seed=0, split_index=0
    Starting now: 2025-07-10 17:25:18.736522
Traceback (most recent call last):
  File "/workspace/pretrain.py", line 278, in <module>
    model = create_model_custom(cfg_name='encoder')
  File "/workspace/pretrain.py", line 161, in create_model_custom
    model = GraphGymModule_custom(dim_in, dim_out, cfg, enter_cfg)
  File "/workspace/pretrain.py", line 89, in __init__
    self.model = network_dict[cfg.model.type](dim_in=dim_in,
  File "/workspace/lgd/model/GraphTransformerEncoder.py", line 516, in __init__
    NodeEncoder = register.node_encoder_dict[cfg.node_encoder_name]
KeyError: 'TypeDictNode'
Autoencoder pretraining failed - no checkpoint found
LGD testing completed. Check logs in /workspace/runs/20250710_172433/
Job completed. Results saved in: /work/jh210022o/q25030/LatentGraphDiffusion/runs/20250710_172433
