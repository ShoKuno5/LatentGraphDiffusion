/opt/conda/lib/python3.10/site-packages/lightning_fabric/__init__.py:40: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
./datasets/ZINC
Downloading https://www.dropbox.com/s/feo9qle74kg48gy/molecules.zip?dl=1
Extracting datasets/ZINC/molecules.zip
Downloading https://raw.githubusercontent.com/graphdeeplearning/benchmarking-gnns/master/data/molecules/train.index
Downloading https://raw.githubusercontent.com/graphdeeplearning/benchmarking-gnns/master/data/molecules/val.index
Downloading https://raw.githubusercontent.com/graphdeeplearning/benchmarking-gnns/master/data/molecules/test.index
Processing...
  0%|          | 0/10000 [00:00<?, ?it/s]Processing train dataset:   0%|          | 0/10000 [00:00<?, ?it/s]Processing train dataset:   0%|          | 1/10000 [00:00<44:56,  3.71it/s]Processing train dataset:  20%|██        | 2036/10000 [00:00<00:01, 7048.10it/s]Processing train dataset:  41%|████      | 4080/10000 [00:00<00:00, 11478.65it/s]Processing train dataset:  61%|██████▏   | 6140/10000 [00:00<00:00, 14405.48it/s]Processing train dataset:  82%|████████▏ | 8213/10000 [00:00<00:00, 16392.31it/s]Processing train dataset: 100%|██████████| 10000/10000 [00:01<00:00, 8740.28it/s]
  0%|          | 0/1000 [00:00<?, ?it/s]Processing val dataset:   0%|          | 0/1000 [00:00<?, ?it/s]Processing val dataset:  51%|█████     | 512/1000 [00:00<00:00, 5119.85it/s]Processing val dataset: 100%|██████████| 1000/1000 [00:00<00:00, 8102.96it/s]
  0%|          | 0/1000 [00:00<?, ?it/s]Processing test dataset:   0%|          | 0/1000 [00:00<?, ?it/s]Processing test dataset: 100%|██████████| 1000/1000 [00:00<00:00, 14944.32it/s]
Done!
[*] Loaded dataset 'subset' from 'PyG-ZINC':
/opt/conda/lib/python3.10/site-packages/torch_geometric/data/in_memory_dataset.py:157: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
  Data(x=[277864, 1], edge_index=[2, 597970], edge_attr=[597970], y=[12000])
  undirected: True
  num graphs: 12000
/opt/conda/lib/python3.10/site-packages/torch_geometric/data/in_memory_dataset.py:157: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
  avg num_nodes/graph: 23
  num node features: 1
  num edge features: 1
  num classes: (appears to be a regression task)
Precomputing Positional Encoding statistics: ['RRWP'] for all graphs...
  ...estimated to be undirected: True
  0%|          | 0/12000 [00:00<?, ?it/s]100%|██████████| 12000/12000 [00:07<00:00, 1507.38it/s]
Done! Took 00:00:08.94
Adding virtual node and edges
  0%|          | 0/12000 [00:00<?, ?it/s]100%|██████████| 12000/12000 [00:07<00:00, 1629.72it/s]
Preprocessing PE
  0%|          | 0/12000 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/workspace/pretrain.py", line 272, in <module>
    loaders = create_loader()
  File "/opt/conda/lib/python3.10/site-packages/torch_geometric/graphgym/loader.py", line 316, in create_loader
    dataset = create_dataset()
  File "/opt/conda/lib/python3.10/site-packages/torch_geometric/graphgym/loader.py", line 242, in create_dataset
    dataset = load_dataset()
  File "/opt/conda/lib/python3.10/site-packages/torch_geometric/graphgym/loader.py", line 187, in load_dataset
    dataset = func(format, name, dataset_dir)
  File "/workspace/lgd/loader/master_loader.py", line 372, in load_dataset_master
    pre_transform_in_memory(dataset,
  File "/workspace/lgd/transform/transforms.py", line 30, in pre_transform_in_memory
    data_list = [transform_func(dataset.get(i))
  File "/workspace/lgd/transform/transforms.py", line 30, in <listcomp>
    data_list = [transform_func(dataset.get(i))
  File "/workspace/lgd/transform/transforms.py", line 303, in pretransform_pe
    if pestat_node:
RuntimeError: Boolean value of Tensor with more than one value is ambiguous
  0%|          | 0/12000 [00:00<?, ?it/s]
